<!DOCTYPE html><html><head><title>fs2-blobstore: S3</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="fs2-blobstore" /><meta name="description" content="Unified fs2 interface for various storage services" /><meta name="og:image" content="/fs2-blobstore/img/poster.png" /><meta name="image" property="og:image" content="/fs2-blobstore/img/poster.png" /><meta name="og:title" content="fs2-blobstore: S3" /><meta name="title" property="og:title" content="fs2-blobstore: S3" /><meta name="og:site_name" content="fs2-blobstore" /><meta name="og:url" content="https://github.com/fs2-blobstore/fs2-blobstore" /><meta name="og:type" content="website" /><meta name="og:description" content="Unified fs2 interface for various storage services" /><link rel="icon" type="image/png" href="/fs2-blobstore/img/favicon.png" /><meta name="twitter:title" content="fs2-blobstore: S3" /><meta name="twitter:image" content="/fs2-blobstore/img/poster.png" /><meta name="twitter:description" content="Unified fs2 interface for various storage services" /><meta name="twitter:card" content="summary_large_image" /><link rel="icon" type="image/png" sizes="16x16" href="/fs2-blobstore/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="24x24" href="/fs2-blobstore/img/favicon24x24.png" /><link rel="icon" type="image/png" sizes="32x32" href="/fs2-blobstore/img/favicon32x32.png" /><link rel="icon" type="image/png" sizes="48x48" href="/fs2-blobstore/img/favicon48x48.png" /><link rel="icon" type="image/png" sizes="57x57" href="/fs2-blobstore/img/favicon57x57.png" /><link rel="icon" type="image/png" sizes="60x60" href="/fs2-blobstore/img/favicon60x60.png" /><link rel="icon" type="image/png" sizes="64x64" href="/fs2-blobstore/img/favicon64x64.png" /><link rel="icon" type="image/png" sizes="70x70" href="/fs2-blobstore/img/favicon70x70.png" /><link rel="icon" type="image/png" sizes="72x72" href="/fs2-blobstore/img/favicon72x72.png" /><link rel="icon" type="image/png" sizes="76x76" href="/fs2-blobstore/img/favicon76x76.png" /><link rel="icon" type="image/png" sizes="96x96" href="/fs2-blobstore/img/favicon96x96.png" /><link rel="icon" type="image/png" sizes="114x114" href="/fs2-blobstore/img/favicon114x114.png" /><link rel="icon" type="image/png" sizes="120x120" href="/fs2-blobstore/img/favicon120x120.png" /><link rel="icon" type="image/png" sizes="128x128" href="/fs2-blobstore/img/favicon128x128.png" /><link rel="icon" type="image/png" sizes="144x144" href="/fs2-blobstore/img/favicon144x144.png" /><link rel="icon" type="image/png" sizes="150x150" href="/fs2-blobstore/img/favicon150x150.png" /><link rel="icon" type="image/png" sizes="152x152" href="/fs2-blobstore/img/favicon152x152.png" /><link rel="icon" type="image/png" sizes="196x196" href="/fs2-blobstore/img/favicon196x196.png" /><link rel="icon" type="image/png" sizes="310x310" href="/fs2-blobstore/img/favicon310x310.png" /><link rel="icon" type="image/png" sizes="310x150" href="/fs2-blobstore/img/favicon310x150.png" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/fs2-blobstore/highlight/styles/vs.css" /><link rel="stylesheet" href="/fs2-blobstore/css/light-style.css" /></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><div id="sidebar-brand"><a href="/fs2-blobstore/" class="brand"><div class="brand-wrapper"></div><span>fs2-blobstore</span></a><button id="main-toggle" class="sidebar-toggle"><span class="close"></span></button></div><div class="sidebar-nav"> <div class="sidebar-nav-item  "><a href="/fs2-blobstore/documentation/data-model" title="Data model" class="">Data model</a></div> <div class="sidebar-nav-item  open"><a href="/fs2-blobstore/documentation/stores.html" title="Stores" class="drop-nested">Stores</a><i class="fa fa-angle-right"></i><div class="sub-section"> <a href="/fs2-blobstore/documentation/stores/gcs.html" title="GCS" class="">GCS</a> <a href="/fs2-blobstore/documentation/stores/s3.html" title="S3" class="active">S3</a> <a href="/fs2-blobstore/documentation/stores/azure.html" title="Azure" class="">Azure</a> <a href="/fs2-blobstore/documentation/stores/sftp.html" title="SFTP" class="">SFTP</a> <a href="/fs2-blobstore/documentation/stores/box.html" title="Box" class="">Box</a></div></div></div></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"></ul></div></div></div></div><div id="content" data-github-owner="fs2-blobstore" data-github-repo="fs2-blobstore"><div class="content-wrapper"><section><h1 id="s3">S3</h1>

<p>This store is used to interface with AWS S3. Head over to the official <a href="https://docs.aws.amazon.com/sdk-for-java/latest/developer-guide/home.html">documentation</a> for the Java client for details on how to configure it. Here in an example using access- and secret keys.</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">blobstore.s3.</span><span class="o">{</span><span class="n">S3Store</span><span class="o">,</span> <span class="n">S3MetaInfo</span><span class="o">}</span>
<span class="k">import</span> <span class="nn">blobstore.url.Url</span>
<span class="k">import</span> <span class="nn">cats.effect.Async</span>

<span class="k">import</span> <span class="nn">software.amazon.awssdk.auth.credentials.</span><span class="o">{</span><span class="nc">AwsBasicCredentials</span><span class="o">,</span> <span class="nc">StaticCredentialsProvider</span><span class="o">}</span>
<span class="k">import</span> <span class="nn">software.amazon.awssdk.regions.Region</span>
<span class="k">import</span> <span class="nn">software.amazon.awssdk.services.s3.S3AsyncClient</span>

<span class="k">def</span> <span class="nf">createS3</span><span class="o">[</span><span class="kt">F</span><span class="o">[</span><span class="k">_</span><span class="o">]</span><span class="kt">:</span> <span class="kt">Async</span><span class="o">]</span><span class="k">:</span> <span class="kt">S3Store</span><span class="o">[</span><span class="kt">F</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
  <span class="k">val</span> <span class="nv">client</span><span class="k">:</span> <span class="kt">S3AsyncClient</span> <span class="o">=</span> <span class="n">S3AsyncClient</span>
    <span class="o">.</span><span class="py">builder</span><span class="o">()</span>
    <span class="o">.</span><span class="py">region</span><span class="o">(</span><span class="nv">Region</span><span class="o">.</span><span class="py">US_EAST_1</span><span class="o">)</span>
    <span class="o">.</span><span class="py">credentialsProvider</span><span class="o">(</span><span class="nv">StaticCredentialsProvider</span><span class="o">.</span><span class="py">create</span><span class="o">(</span><span class="nv">AwsBasicCredentials</span><span class="o">.</span><span class="py">create</span><span class="o">(</span><span class="s">"access_key"</span><span class="o">,</span> <span class="s">"secret_key"</span><span class="o">)))</span>
    <span class="o">.</span><span class="py">build</span><span class="o">()</span>
  
  <span class="nv">S3Store</span><span class="o">.</span><span class="py">builder</span><span class="o">[</span><span class="kt">F</span><span class="o">](</span><span class="n">client</span><span class="o">).</span><span class="py">unsafe</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Creation of the S3 client is effectful due to input parameter validation. The generic API makes no assumptions on the type of the underlying object. If you want to use S3 specific features such as server side encryption, object versions or ACLs, you can find S3 specific APIs in <code class="highlighter-rouge">S3Store[F]</code> that allows that. Here is an example for SSE</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">s3SseGet</span><span class="o">[</span><span class="kt">F</span><span class="o">[</span><span class="k">_</span><span class="o">]](</span><span class="n">s3</span><span class="k">:</span> <span class="kt">S3Store</span><span class="o">[</span><span class="kt">F</span><span class="o">],</span> <span class="n">url</span><span class="k">:</span> <span class="kt">Url.Plain</span><span class="o">,</span> <span class="n">sseKey</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span><span class="k">:</span> <span class="kt">fs2.Stream</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">Byte</span><span class="o">]</span> <span class="k">=</span> 
    <span class="nv">s3</span><span class="o">.</span><span class="py">get</span><span class="o">(</span><span class="n">url</span><span class="o">,</span> <span class="nv">S3MetaInfo</span><span class="o">.</span><span class="py">const</span><span class="o">(</span><span class="n">constSseCustomerKey</span> <span class="k">=</span> <span class="nc">Some</span><span class="o">(</span><span class="n">sseKey</span><span class="o">)))</span>
</code></pre></div></div>
</section></div></div></div></div><script src="/fs2-blobstore/highlight/highlight.pack.js"></script><script>
// For all code blocks, copy the language from the containing div
// to the inner code tag (where hljs expects it to be)
const langPrefix = 'language-';
document.querySelectorAll(`div[class^='${langPrefix}']`).forEach(function(div) {
  div.classList.forEach(function(cssClass) {
    if (cssClass.startsWith(langPrefix)) {
      const lang = cssClass.substring(langPrefix.length);
      div.querySelectorAll('pre code').forEach(function(code) {
        code.classList.add(lang);
      });
    }
  });
});

hljs.configure({languages:['scala','java','bash']});
hljs.initHighlightingOnLoad();
      </script><script>console.info('\x57\x65\x62\x73\x69\x74\x65\x20\x62\x75\x69\x6c\x74\x20\x77\x69\x74\x68\x3a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x5f\x5f\x20\x20\x20\x20\x5f\x5f\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x5f\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x5f\x20\x5f\x5f\x0a\x20\x20\x20\x5f\x5f\x5f\x5f\x5f\x2f\x20\x2f\x5f\x20\x20\x2f\x20\x2f\x5f\x20\x20\x20\x20\x20\x20\x5f\x5f\x5f\x5f\x20\x5f\x5f\x5f\x20\x20\x28\x5f\x29\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x20\x20\x5f\x5f\x5f\x5f\x5f\x28\x5f\x29\x20\x2f\x5f\x5f\x5f\x5f\x20\x20\x5f\x5f\x5f\x5f\x5f\x0a\x20\x20\x2f\x20\x5f\x5f\x5f\x2f\x20\x5f\x5f\x20\x5c\x2f\x20\x5f\x5f\x2f\x5f\x5f\x5f\x5f\x5f\x2f\x20\x5f\x5f\x20\x60\x5f\x5f\x20\x5c\x2f\x20\x2f\x20\x5f\x5f\x5f\x2f\x20\x5f\x5f\x5f\x2f\x20\x5f\x5f\x20\x5c\x2f\x20\x5f\x5f\x5f\x2f\x20\x2f\x20\x5f\x5f\x2f\x20\x5f\x20\x5c\x2f\x20\x5f\x5f\x5f\x2f\x0a\x20\x28\x5f\x5f\x20\x20\x29\x20\x2f\x5f\x2f\x20\x2f\x20\x2f\x5f\x2f\x5f\x5f\x5f\x5f\x5f\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x5f\x5f\x2f\x20\x2f\x20\x20\x2f\x20\x2f\x5f\x2f\x20\x28\x5f\x5f\x20\x20\x29\x20\x2f\x20\x2f\x5f\x2f\x20\x20\x5f\x5f\x28\x5f\x5f\x20\x20\x29\x0a\x2f\x5f\x5f\x5f\x5f\x2f\x5f\x2e\x5f\x5f\x5f\x2f\x5c\x5f\x5f\x2f\x20\x20\x20\x20\x20\x2f\x5f\x2f\x20\x2f\x5f\x2f\x20\x2f\x5f\x2f\x5f\x2f\x5c\x5f\x5f\x5f\x2f\x5f\x2f\x20\x20\x20\x5c\x5f\x5f\x5f\x5f\x2f\x5f\x5f\x5f\x5f\x2f\x5f\x2f\x5c\x5f\x5f\x2f\x5c\x5f\x5f\x5f\x2f\x5f\x5f\x5f\x5f\x2f\x0a\x0a\x68\x74\x74\x70\x73\x3a\x2f\x2f\x34\x37\x64\x65\x67\x2e\x67\x69\x74\x68\x75\x62\x2e\x69\x6f\x2f\x73\x62\x74\x2d\x6d\x69\x63\x72\x6f\x73\x69\x74\x65\x73')</script><script src="/fs2-blobstore/js/search.js"></script><script src="/fs2-blobstore/js/docs.js"></script></body></html>